(()=>{"use strict";var e={d:(t,s)=>{for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{getCustom:()=>m,getFormInfo:()=>p,getModifiedSettings:()=>f,getSections:()=>b,getSettings:()=>u});var s={};e.r(s),e.d(s,{resetFormSaveState:()=>v,saveSettings:()=>S,updateCustom:()=>_,updateSetting:()=>h});const n=window.React,i=window.wp.element,a=window.wp.i18n,l=window.wp.compose,o=window.wp.components,c=window.wp.data,r=window.wp.plugins,g=window.wp.dataControls,d={form:{fail:!1,success:!1,is_saving:!1},custom:[],modifiedSettings:[],...genesisBlocksSettingsData},u=e=>e.settings||{},m=e=>e.custom||{},p=e=>e.form||{};function b(e){return e.hasOwnProperty("sections")?e.sections:{}}const f=e=>e.modifiedSettings||[];function h(e){return{type:"UPDATE_SETTING",setting:e}}function _(e){return{type:"UPDATE_CUSTOM",setting:e}}function v(){return{type:"RESET"}}function*S(e){yield{type:"SAVING"};let t=null;try{wp.data.dispatch("core").saveSite(e),t=!0}catch(e){t=!1}return{type:"SAVED",success:t}}window.wp.coreData;const k={selectors:t,actions:s,reducer:(e=d,t)=>"UPDATE_CUSTOM"===t.type?{...e,custom:{...e.custom,[t.setting.key]:t.setting.value}}:"UPDATE_SETTING"===t.type?{...e,settings:{...e.settings,[t.setting.key]:t.setting.value},modifiedSettings:{...e.modifiedSettings,[t.setting.key]:t.setting.value}}:"SAVING"===t.type?{...e,form:{...e.form,fail:!1,success:!1,is_saving:!0}}:"SAVED"===t.type?{...e,form:{...e.form,success:!0===t.success,fail:!0!==t.success,is_saving:!1},modifiedSettings:t.success?[]:e.modifiedSettings}:"RESET"===t.type?{...e,form:{...e.form,fail:!1,success:!1,is_saving:!1}}:e,controls:g.controls},y=((0,c.registerStore)("genesis-blocks/global-settings",k),window.wp.a11y),w=window.wp.hooks,E=(0,l.compose)([(0,c.withSelect)(e=>({form:e("genesis-blocks/global-settings").getFormInfo(),settings:e("genesis-blocks/global-settings").getModifiedSettings(),custom:e("genesis-blocks/global-settings").getCustom()}))])(function({form:e,settings:t,custom:s,children:a,successMessage:l,failMessage:r,messageDuration:g}){const d=(0,i.useRef)();return(0,n.createElement)(n.Fragment,null,(0,n.createElement)(o.Button,{isPrimary:!0,isBusy:e.is_saving,disabled:e.is_saving,onClick:function(){(0,w.doAction)("genesisBlocks.savingSettings",t,s),clearTimeout(d.current),(0,c.dispatch)("genesis-blocks/global-settings").saveSettings(t)},className:"genesis-blocks-settings-save has-notices"},a),e.success||e.fail?function(){d.current=setTimeout(()=>(0,c.dispatch)("genesis-blocks/global-settings").resetFormSaveState(),1e3*g);const t=e.success?l:r;(0,y.speak)(t,"polite");const s="genesis-blocks-save-notice"+(e.success?" success":"")+(e.fail?" fail":"");return(0,n.createElement)("span",{className:s},t)}():"")}),C=(0,l.compose)([(0,c.withDispatch)(()=>({onUpdate(e){(0,c.dispatch)("genesis-blocks/global-settings").updateSetting({key:e.key,value:e.value})}}))])(function({settings:e,field:t,onUpdate:s}){return(0,n.createElement)(o.CheckboxControl,{className:t.class,heading:t.heading,label:t.label,help:t.help,checked:!!e[t.id]&&e[t.id],onChange:e=>s({key:t.id,value:e})})}),T=window.lodash,N=window.wp.blockEditor,U=["image"],D=(0,a.__)("Image"),I=(0,a.__)("Select an image"),P=(0,a.__)("Choose image"),M=(0,a.__)("Replace image"),A=(0,a.__)("Remove image"),O=(0,c.withSelect)((e,t)=>{const{getMedia:s}=e("core"),n=t.settings[t.field.id];return{media:n?s(n):null,imageId:n}}),F=(0,c.withDispatch)((e,t)=>{const{updateSetting:s}=e("genesis-blocks/global-settings");return{onUpdateImage(e){s({key:t.field.id,value:e.id})},onRemoveImage(){s({key:t.field.id,value:null})}}}),R={checkbox:C,html:function({field:e}){return(0,n.createElement)("div",{dangerouslySetInnerHTML:{__html:e.content}})},image:(0,l.compose)(O,F)(function({field:e,imageId:t,media:s,onUpdateImage:i,onRemoveImage:a}){let l,c,r;if(s){const t=e.image_size||"thumbnail";(0,T.has)(s,["media_details","sizes",t])?(l=s.media_details.sizes[t].width,c=s.media_details.sizes[t].height,r=s.media_details.sizes[t].source_url):(l=s.media_details.width,c=s.media_details.height,r=s.source_url)}return(0,n.createElement)(n.Fragment,null,(0,n.createElement)("div",{className:"genesis-blocks-settings-image"},(0,n.createElement)("p",{className:"components-base-control__label"},e.label||D),(0,n.createElement)(N.MediaUpload,{title:e.label_media_modal||I,onSelect:i,allowedTypes:U,render:({open:i})=>(0,n.createElement)("div",{className:"genesis-blocks-settings-image__container"},(0,n.createElement)(o.Button,{className:t?"genesis-blocks-settings-image__preview":"genesis-blocks-settings-image__toggle",onClick:i,"aria-label":e.label_button_aria||null,isSecondary:!0},!!t&&s&&(0,n.createElement)(o.ResponsiveWrapper,{naturalWidth:l,naturalHeight:c,isInline:!0},(0,n.createElement)("img",{src:r,alt:""})),!!t&&!s&&(0,n.createElement)(o.Spinner,null),!t&&(e.label_button||P))),value:t}),!!t&&s&&!s.isLoading&&(0,n.createElement)(N.MediaUpload,{title:e.label_media_modal||I,onSelect:i,allowedTypes:U,modalClass:"genesis-blocks-settings-image__media-modal",render:({open:t})=>(0,n.createElement)(o.Button,{onClick:t,isSecondary:!0,"aria-label":e.label_replace_aria||null},e.label_replace||M)}),!!t&&(0,n.createElement)(o.Button,{onClick:a,isLink:!0,isDestructive:!0,"aria-label":e.label_remove_aria||null},e.label_remove||A),!!e.help&&(0,n.createElement)("p",{id:e.id+"__help",className:"components-base-control__help"},e.help)))}),radio:(0,l.compose)([(0,c.withDispatch)(()=>({onUpdate(e){(0,c.dispatch)("genesis-blocks/global-settings").updateSetting({key:e.key,value:e.value})}}))])(function({settings:e,field:t,onUpdate:s}){return(0,n.createElement)(o.RadioControl,{className:t.class,label:t.label,help:t.help,selected:!!e[t.id]&&e[t.id],options:function(e){const t=[];for(const[s,n]of Object.entries(e))t.push({value:s,label:n});return t}(t.options),onChange:e=>s({key:t.id,value:e})})}),select:(0,l.compose)([(0,c.withDispatch)(()=>({onUpdate(e){(0,c.dispatch)("genesis-blocks/global-settings").updateSetting({key:e.key,value:e.value})}}))])(function({settings:e,field:t,onUpdate:s}){return(0,n.createElement)(o.SelectControl,{className:t.class,label:t.label,help:t.help?t.help:"",value:!!e[t.id]&&e[t.id],options:function(e){const t=[];for(const[s,n]of Object.entries(e))t.push({value:s,label:n});return t}(t.options),onChange:e=>s({key:t.id,value:e})})}),text:(0,l.compose)([(0,c.withDispatch)(()=>({onUpdate(e){(0,c.dispatch)("genesis-blocks/global-settings").updateSetting({key:e.key,value:e.value})}}))])(function({settings:e,field:t,onUpdate:s}){return(0,n.createElement)(o.TextControl,{className:t.class,label:t.label?t.label:"",help:t.help?t.help:"",onChange:e=>s({key:t.id,value:e}),value:e[t.id]?e[t.id]:""})}),textarea:(0,l.compose)([(0,c.withDispatch)(()=>({onUpdate(e){(0,c.dispatch)("genesis-blocks/global-settings").updateSetting({key:e.key,value:e.value})}}))])(function({settings:e,field:t,onUpdate:s}){return(0,n.createElement)(o.TextareaControl,{className:t.class,label:t.label?t.label:"",help:t.help?t.help:"",onChange:e=>s({key:t.id,value:e}),value:e[t.id]?e[t.id]:""})})},B=(0,l.compose)([(0,c.withSelect)(()=>({settings:(0,c.select)("genesis-blocks/global-settings").getSettings(),sections:(0,c.select)("genesis-blocks/global-settings").getSections()}))])(function({settings:e,sections:t}){return(0,n.createElement)(n.Fragment,null,(0,n.createElement)(o.TabPanel,{className:"genesis-blocks-settings-sections",activeClass:"gb-nav-tab-active",onSelect:function(){(0,c.dispatch)("genesis-blocks/global-settings").resetFormSaveState()},tabs:Object.values(function(e){for(const t in e)e[t].className="gb-nav-tab gb-admin-button";return e}(t))},t=>(0,n.createElement)("div",{className:"gb-admin-plugin-admin-body"},(0,n.createElement)("div",{className:"gb-admin-plugin-container"},function(t){if(t.hasOwnProperty("fields")&&Array.isArray(t.fields)){const s=t.fields.map(function(t,s){if(!R.hasOwnProperty(t.type))return"";const i=R[t.type];return(0,n.createElement)(i,{key:s,settings:e,field:t})});if(s.length>0)return(0,n.createElement)(n.Fragment,null,s)}return(0,n.createElement)("p",null,(0,a.__)("No fields found for this section.","genesis-blocks"))}(t),(0,n.createElement)(o.SlotFillProvider,null,(0,n.createElement)(o.Slot,{name:"GenesisBlocksSettings_"+t.name.replace("genesis_blocks_settings_","")}),(0,n.createElement)(r.PluginArea,null)),(0,n.createElement)(E,{successMessage:(0,a.__)("Settings saved","genesis-blocks"),failMessage:(0,a.__)("Saving failed","genesis-blocks"),messageDuration:"2"},(0,a.__)("Save All","genesis-blocks"))))))});(0,i.render)((0,n.createElement)(B,null),document.getElementById("root"))})();